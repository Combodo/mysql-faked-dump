# Mysql faked dump
Create censored dump with a finger snap!

## installation
```bash
composer install
```

## usage

Just call `bin/console mysql-faked:dump` with one parameter: the path to a valid config file.
It will output the dump on the stdout.
For large databases, the dump progress is output on the stderr

you can store the dump by redirecting stdout to a file:
```bash
bin/console mysql-faked:dump path/to/file.yaml > ~/Desktop/dump.sql
```

or directly execute it : 
```bash
bin/console mysql-faked:dump path/to/file.yaml |  | mysql --host=remote_host -C db_name
```

this command accept two options :
 - add-drop-table
 - skip-create-table
 

## configuration
The configuration is written in yaml, it has tree main entries.

##### example: 
```yaml
data_source:
  dsn: 'mysql:dbname=foo;host=localhost;port=3600'
  user: 'root'
  password: ~
  options: []
options:
  exclude_missing_tables: false
tables:
  fos_user:
    columns:
      email:
        faker: email
        alias: [email_canonical]
      last_name:
        faker: lastName
      company:
        faker: company
      password:
        empty: true
  oauth_*:
    pattern: "oauth_.*"
    exclude: true
```

##### data_source: 
This part describe how to connect to mysql.
see  [PDO::__construct] in order to see how to configure it more deeply

##### options: 
for now only one option exists:

 - `exclude_missing_tables`: whether non mapped table should be dumped or ignored. 


##### tables
This entry let you configure special cases:
 - ignore tables: `exclude: true`
 - special values for columns
   - empty value: `empty: true`
   - fake value : `faker: company`

NB : fake values are generated by using the [Faker] library, so you can use every formatter provided, or even write your own.

   
###### pattern  
If you want to map many table within on conf entry, use an impossible to math table name  (ie: `oauth_*`) and add a regex `pattern: "oauth_.*"`.
 
###### alias 
Faker will give you a different result on each call, so if you want many columns to share the same value, use the `alias: []` entry  


[PDO::__construct]: http://php.net/manual/fr/pdo.construct.php
[Faker]: https://github.com/fzaninotto/Faker#formatters